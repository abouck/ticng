"use strict";angular.module("newTicApp",["firebase"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("newTicApp").controller("MainCtrl",["$scope","angularFire",function(a,b){a.games=[],a.queue={},a.turnWait=!1;var c=new Firebase("https://ticsntacs.firebaseio.com/games");b(c,a,"games").then(function(){var c=new Firebase("https://ticsntacs.firebaseio.com/queue");b(c,a,"queue").then(function(){if(void 0==a.queue.gameId){console.log("I'm player 1"),a.player="X";var b={board:[[{value:"",r:1,c:1},{value:"",r:1,c:2},{value:"",r:1,c:3}],[{value:"",r:2,c:1},{value:"",r:2,c:2},{value:"",r:2,c:3}],[{value:"",r:3,c:1},{value:"",r:3,c:2},{value:"",r:3,c:3}]],turn:"X",waiting:!0,win:!1,winner:"",draw:!1,turnCount:0};a.gameId=a.games.push(b)-1,a.queue.gameId=a.gameId,console.log("Player 1's game is: "+a.gameId),document.getElementById("gamebox").setAttribute("style","background-image:url(img/"+a.player+".png)")}else console.log("I'm player 2"),a.player="O",a.gameId=a.queue.gameId,a.queue={},console.log("Player 2's game is: "+a.gameId),a.games[a.gameId].waiting=!1,document.getElementById("gamebox").setAttribute("style","background-image:url(img/"+a.player+".png)")})}),a.fill=function(b,c){a.games[a.gameId].waiting||a.games[a.gameId].turn!=a.player||("X"==b.value||"O"==b.value?alert("Please Choose an Empty Square!"):(b.value=1!=a.games[a.gameId].turnCount%2?"X":"O",++a.games[a.gameId].turnCount),a.win(c,b),0==a.games[a.gameId].win&&"X"==a.player?a.games[a.gameId].turn="O":0==a.games[a.gameId].win&&(a.games[a.gameId].turn="X"))},a.win=function(){a.turnWait=!1;for(var b=0,c=a.games[a.gameId].board.length,d=0;c>d;d++){b=0;for(var e=0;c>e;e++)switch(a.games[a.gameId].board[d][e].value){case"X":++b;break;case"O":--b}3==Math.abs(b)&&a.winner()}for(var d=0;c>d;d++){b=0;for(var e=0;c>e;e++)switch(a.games[a.gameId].board[e][d].value){case"X":++b;break;case"O":--b}3==Math.abs(b)&&a.winner()}for(var f=0,g=0,d=0;c>d;++d){switch(a.games[a.gameId].board[d][d].value){case"X":++f;break;case"O":--f}switch(a.games[a.gameId].board[d][c-1-d].value){case"X":++g;break;case"O":--g}f==c&&a.winner(),f==-c&&a.winner(),g==c&&a.winner(),g==-c&&a.winner()}a.cats=!1;for(var h=0,d=0;c>d;d++){b=0;for(var e=0;c>e;e++)""!=a.games[a.gameId].board[d][e].value&&++h}9==h&&1!=a.gameWon&&(a.cats=!0,a.games[a.gameId].draw=!0)},a.winner=function(){a.games[a.gameId].winner=a.player,a.games[a.gameId].win=!0},a.newGame=function(){location.reload(!0)}}]);